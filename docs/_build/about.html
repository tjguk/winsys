
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>About WinSys &#8212; WinSys 1.0beta documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="author" title="About these documents" href="#" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modules" href="modules.html" />
    <link rel="prev" title="WinSys - Python tools for the Windows Administrator" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="WinSys - Python tools for the Windows Administrator"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">WinSys 1.0beta documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="about-winsys">
<span id="id1"></span><h1>About WinSys<a class="headerlink" href="#about-winsys" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="http://msdn.microsoft.com/en-us/library/default.aspx">Windows API</a>
offers the would-be system administrator a plethora of
low-level tools to secure files, log changes, investigate problems and
do whatever else might be needed to a Windows system. The <a class="reference external" href="https://sourceforge.net/projects/pywin32/">pywin32 extensions
for Windows</a> offer an enormous
amount of that functionality to the Python user. And the builtin
<a class="reference external" href="http://docs.python.org/library/ctypes.html">ctypes library</a> allows you to
fill in the gaps.</p>
<p>But it’s all quite low-level and the examples are mostly in C. And all you
want to do is take ownership of a bunch of files, move them to an archive
area and compress them there. And you want to do that for the home folder of
every user who’s left the company. And you want to do that every Sunday
morning.</p>
<p>Enter WinSys: the Python Windows Administrator’s Toolkit. A collection
of modules with a consistent approach, wrapping the Windows API
calls already exposed by pywin32, adding some with ctypes, and giving them
all a pythonic feel. There’s nothing here you couldn’t do yourself with
10 minutes and a copy of the pywin32 and SDK docs. But it’s all here already,
and with a more Pythonish feel about it.</p>
<div class="section" id="design-principles">
<h2>Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this headline">¶</a></h2>
<p>The following principles have directed the design of the modules
and packages wherever possible:</p>
<ul class="simple">
<li><p>Make ad-hoc use possible and easy (and even attractive)</p></li>
<li><p>Provide sensible defaults for the common cases, always allowing for more complex scenarios</p></li>
<li><p>Put all constants into one place, grouping them according to their API usage</p></li>
<li><p>Use the pywin32 functionality where available, supplementing it with ctypes where needed</p></li>
<li><p>Assume a recent version of Python (tested on 2.6, 2.7, 3.2 and 3.3)</p></li>
<li><p>Make good use of context managers (with-statements)</p></li>
<li><p>Have each object able to dump its contents and that of its children cleanly</p></li>
<li><p>Maintain an object approach, but provide convenient module-level functions</p></li>
<li><p>Have useful factory functions for classes, robustly accepting string or object parameters</p></li>
</ul>
</div>
<div class="section" id="common-features">
<h2>Common Features<a class="headerlink" href="#common-features" title="Permalink to this headline">¶</a></h2>
<p>Most of the objects in winsys subclass the <a class="reference internal" href="core.html#core._WinSysObject" title="core._WinSysObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">core._WinSysObject</span></code></a> class which
offers sensible defaults and defines common functionality such as a dump function.
In addition, the following features are common to many of the modules:</p>
<div class="section" id="pythonic-naming">
<h3>Pythonic Naming<a class="headerlink" href="#pythonic-naming" title="Permalink to this headline">¶</a></h3>
<p>This is mildly contentious, but the same naming convention has been used
throughout, following the <code class="docutils literal notranslate"><span class="pre">lowercase_with_underscores</span></code> convention widely
adopted in the Python community. The most widespread exception to this is
in the <a class="reference internal" href="constants.html#module-constants" title="constants: Constants"><code class="xref py py-mod docutils literal notranslate"><span class="pre">constants</span></code></a> module, where Windows constants retain their
<code class="docutils literal notranslate"><span class="pre">UPPERCASE_WITH_UNDERSCORES</span></code> names.</p>
</div>
<div class="section" id="module-level-functions">
<h3>Module-level Functions<a class="headerlink" href="#module-level-functions" title="Permalink to this headline">¶</a></h3>
<p>While a lot of use has been made of Python classes to wrap the function-driven
Windows API, a lot of the functionality has been exposed as module-level
convenience functions. So, for example, in the <a class="reference internal" href="fs.html#module-fs" title="fs: Files, Directories, &amp;c."><code class="xref py py-mod docutils literal notranslate"><span class="pre">fs</span></code></a> module, the <a class="reference internal" href="fs_file.html#fs.File" title="fs.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">fs.File</span></code></a>
class offers a <a class="reference internal" href="fs_file.html#fs.File.copy" title="fs.File.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fs.File.copy()</span></code></a> method, but the same functionality is exposed
at the module level as <a class="reference internal" href="fs.html#fs.copy" title="fs.copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">fs.copy()</span></code></a>. That way, you don’t have to instantiate
one or more objects simply for the purpose of a single operation.</p>
</div>
<div class="section" id="factory-functions">
<h3>Factory Functions<a class="headerlink" href="#factory-functions" title="Permalink to this headline">¶</a></h3>
<p>Most of the classes have a corresponding factory function (usually with
the same name in lower case) which tries to be more accepting in what
its parameters are and to convert them to what’s needed by the class’s
own <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method. So, for example, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Principal</span></code> class whose
initialiser expects a PySID structure has a corresponding <code class="xref py py-func docutils literal notranslate"><span class="pre">principal()</span></code>
function which will take a Sid or a user or group name or None or an existing
<code class="xref py py-class docutils literal notranslate"><span class="pre">Principal</span></code> object.</p>
</div>
<div class="section" id="dump">
<h3>Dump<a class="headerlink" href="#dump" title="Permalink to this headline">¶</a></h3>
<p>Each object derived from <a class="reference internal" href="core.html#core._WinSysObject" title="core._WinSysObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">core._WinSysObject</span></code></a> has a dump method which
is intended to display its internal structures, possibly recursively where
some of the structures are themselves WinSys objects. This is intended more
for ad-hoc use in the interpreter where it’s convenient to see, eg, the
security structure which has been loaded from a file.</p>
</div>
<div class="section" id="iterators-generators">
<h3>Iterators &amp; Generators<a class="headerlink" href="#iterators-generators" title="Permalink to this headline">¶</a></h3>
<p>Where possible and meaningful, lazy iterators have been used, often
implemented by generators. This started in the <a class="reference internal" href="fs.html#module-fs" title="fs: Files, Directories, &amp;c."><code class="xref py py-mod docutils literal notranslate"><span class="pre">fs</span></code></a> module where
thousands of files were being queried for information, but the approach
has generally been adopted across the package.</p>
</div>
<div class="section" id="context-managers">
<h3>Context Managers<a class="headerlink" href="#context-managers" title="Permalink to this headline">¶</a></h3>
<p>Where it makes sense, context managers have been used, either by means
of the contextlib contextmanager decorator or by defining an object as
its own context manager by means of <code class="docutils literal notranslate"><span class="pre">__enter__</span></code> and <code class="docutils literal notranslate"><span class="pre">__exit__</span></code> methods.
Examples of context-managed objects include the <a class="reference internal" href="mailslots.html#ipc.Mailslot" title="ipc.Mailslot"><code class="xref py py-class docutils literal notranslate"><span class="pre">ipc.Mailslot</span></code></a> and
<a class="reference internal" href="security.html#security.Security" title="security.Security"><code class="xref py py-class docutils literal notranslate"><span class="pre">security.Security</span></code></a> objects. Examples of decorated functions include
the <a class="reference internal" href="security.html#security.change_privileges" title="security.change_privileges"><code class="xref py py-func docutils literal notranslate"><span class="pre">security.change_privileges()</span></code></a> and <a class="reference internal" href="security.html#security.impersonate" title="security.impersonate"><code class="xref py py-func docutils literal notranslate"><span class="pre">security.impersonate()</span></code></a> functions.</p>
</div>
</div>
<div class="section" id="todo">
<h2>ToDo<a class="headerlink" href="#todo" title="Permalink to this headline">¶</a></h2>
<p>Obviously, there’s loads to do. The Windows API is vast; even the amount of
it exposed by pywin32 far exceeds my immediate needs and the time at my
disposal. The implementation of this package has been driven largely by the
very specific needs of our Windows sysadmins in their day-to-day work. My
intention is to carry on wrapping Windows functionality in a similar way,
but if anyone has particular needs, or can provide functionality to add in,
let’s hear about it.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="contents.html">
              <img class="logo" src="_static/cpython2.png" alt="Logo"/>
            </a></p>
  <h3><a href="contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">About WinSys</a><ul>
<li><a class="reference internal" href="#design-principles">Design Principles</a></li>
<li><a class="reference internal" href="#common-features">Common Features</a><ul>
<li><a class="reference internal" href="#pythonic-naming">Pythonic Naming</a></li>
<li><a class="reference internal" href="#module-level-functions">Module-level Functions</a></li>
<li><a class="reference internal" href="#factory-functions">Factory Functions</a></li>
<li><a class="reference internal" href="#dump">Dump</a></li>
<li><a class="reference internal" href="#iterators-generators">Iterators &amp; Generators</a></li>
<li><a class="reference internal" href="#context-managers">Context Managers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#todo">ToDo</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">WinSys - Python tools for the Windows Administrator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/about.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="WinSys - Python tools for the Windows Administrator"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">WinSys 1.0beta documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013, Tim Golden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.
    </div>
  </body>
</html>